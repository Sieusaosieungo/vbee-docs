"use strict";(self.webpackChunksmartdialog=self.webpackChunksmartdialog||[]).push([[6973],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return h}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(a),h=r,m=d["".concat(s,".").concat(h)]||d[h]||c[h]||i;return a?n.createElement(m,l(l({ref:t},u),{},{components:a})):n.createElement(m,l({ref:t},u))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},1476:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return d}});var n=a(7462),r=a(3366),i=(a(7294),a(3905)),l=["components"],o={sidebar_position:4,sidebar_label:"API"},s="Table of Contents",p={unversionedId:"api-documentation",id:"version-1.1.0/api-documentation",isDocsHomePage:!1,title:"Table of Contents",description:"- Examples",source:"@site/versioned_docs/version-1.1.0/api-documentation.md",sourceDirName:".",slug:"/api-documentation",permalink:"/vbee-docs/1.1.0/api-documentation",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/versioned_docs/version-1.1.0/api-documentation.md",version:"1.1.0",sidebarPosition:4,frontMatter:{sidebar_position:4,sidebar_label:"API"},sidebar:"version-1.1.0/tutorialSidebar",previous:{title:"Deploy your site",permalink:"/vbee-docs/1.1.0/guides/deploy-your-site"},next:{title:"Changelog",permalink:"/vbee-docs/1.1.0/changelog"}},u=[{value:"Dates",id:"dates",children:[]},{value:"Format",id:"format",children:[]},{value:"Special Headers",id:"special-headers",children:[]},{value:"Special Characters",id:"special-characters",children:[]},{value:"HTML UI",id:"html-ui",children:[{value:"API Keys",id:"api-keys",children:[]},{value:"HTTP Basic",id:"http-basic",children:[]}]},{value:"Core Codes",id:"core-codes",children:[]},{value:"Extended Codes",id:"extended-codes",children:[{value:"Inheritance",id:"inheritance",children:[]},{value:"Construction",id:"construction",children:[]}]},{value:"Schema Fields",id:"schema-fields",children:[{value:"Field Validation",id:"field-validation",children:[]},{value:"Character Ranges",id:"character-ranges",children:[]}]},{value:"In Resources",id:"in-resources",children:[]},{value:"In Schema",id:"in-schema",children:[{value:"Pagination",id:"pagination",children:[]},{value:"Sorting",id:"sorting",children:[]},{value:"Filtering",id:"filtering",children:[]},{value:"Root Level",id:"root-level",children:[]},{value:"Version Root",id:"version-root",children:[]},{value:"Individual Resource",id:"individual-resource",children:[]},{value:"Headers only",id:"headers-only",children:[]},{value:"Single resource",id:"single-resource",children:[]},{value:"Single resource - Form Post",id:"single-resource---form-post",children:[]},{value:"Multiple resources",id:"multiple-resources",children:[]},{value:"POST vs. PUT",id:"post-vs-put",children:[]},{value:"Single resource",id:"single-resource-1",children:[]},{value:"Multiple resources",id:"multiple-resources-1",children:[]},{value:"Single resource",id:"single-resource-2",children:[]},{value:"Multiple Resources",id:"multiple-resources-2",children:[]},{value:"All resources in a collection",id:"all-resources-in-a-collection",children:[]},{value:"Deleted Resources",id:"deleted-resources",children:[]}]},{value:"API Versioning",id:"api-versioning",children:[{value:"Listing",id:"listing",children:[]}]},{value:"Asynchronous Actions",id:"asynchronous-actions",children:[]},{value:"Identifiers",id:"identifiers",children:[]},{value:"Canonical Links",id:"canonical-links",children:[]},{value:"In-line Data",id:"in-line-data",children:[]},{value:"Naming Conventions",id:"naming-conventions",children:[]},{value:"URI Conventions",id:"uri-conventions",children:[]},{value:"Performance",id:"performance",children:[{value:"Caching",id:"caching",children:[]},{value:"Compression",id:"compression",children:[]}]},{value:"Query String Length",id:"query-string-length",children:[]},{value:"Regions &amp; Geographic Diversity",id:"regions--geographic-diversity",children:[]},{value:"What to Link",id:"what-to-link",children:[]}],c={toc:u};function d(e){var t=e.components,a=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"table-of-contents"},"Table of Contents"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#examples"},"Examples")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#terminology"},"Terminology")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#representations"},"Representations"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#dates"},"Dates")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#format"},"Format")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#special-headers"},"Special Headers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#special-characters"},"Special Characters")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#html-ui"},"HTML UI")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#authentication"},"Authentication")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#status-codes"},"Status Codes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#resources"},"Resources")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#collections"},"Collections"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#inheritance"},"Inheritance")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#errors"},"Errors")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#links"},"Links"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#construction"},"Construction")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#schemas"},"Schemas"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#schema-fields"},"Schema Fields"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#field-validation"},"Field Validation")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#character-ranges"},"Character Ranges")))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#actions"},"Actions"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#in-resources"},"In Resources")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#in-schema"},"In Schema")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#operations"},"Operations"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#query-operation"},"Query"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#pagination"},"Pagination")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#sorting"},"Sorting")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#filtering"},"Filtering")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#client-request"},"Client Request")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#collection-response"},"Collection Response")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#read-operation"},"Read"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#root-level"},"Root Level")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#version-root"},"Version Root")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#individual-resource"},"Individual Resource")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#headers-only"},"Headers Only")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#create-operation"},"Create"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#single-resource"},"Individual Resource"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#single-resource---form-post"},"Form Post")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#multiple-resources"},"Multiple Resources")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#update-operation"},"Update"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#single-resource-1"},"Individual Resource")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#multiple-resources-1"},"Multiple Resources")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#delete-operation"},"Delete"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#single-resource-2"},"Individual Resource")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#multiple-resources-2"},"Multiple Resources")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#deleted-resources"},"Deleted Resources")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#replace-operation"},"Replace")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#action-operation"},"Action")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#nesting"},"Nesting")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#resource-versioning"},"Resource Versioning")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#base-url-and-versioning"},"Base URL and Versioning")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#design-considerations"},"Design Considerations"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#asynchronous-actions"},"Asynchronous Actions")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#canonical-links"},"Canonical Links")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#identifiers"},"Identifiers")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#inline-data"},"In-line Data")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#naming-conventions"},"Naming Conventions")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#performance"},"Performance"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#caching"},"Caching")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#cache-control"},"Cache-Control"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#etag"},"ETag")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#last-modified"},"Last-Modified")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#compression"},"Compression")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#query-string-length"},"Query String Length")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#regions--geographic-diversity"},"Regions & Geographic Diversity")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#what-to-link"},"What to Link"))))),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"examples"},"Examples"),(0,i.kt)("p",null,"Examples demonstrate a hypothetical file storage API. Only the relevant HTTP request and response information is shown, additional standard HTTP headers will be present in a real request. Examples generally show JSON request and responses, but several ",(0,i.kt)("a",{parentName:"p",href:"#format"},"request")," types are available and other ",(0,i.kt)("a",{parentName:"p",href:"#format"},"response")," types may be defined in the future."),(0,i.kt)("h1",{id:"terminology"},"Terminology"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"REST:"),"\nA ",(0,i.kt)("strong",{parentName:"p"},"RE"),"presentational ",(0,i.kt)("strong",{parentName:"p"},"S"),"tate ",(0,i.kt)("strong",{parentName:"p"},"T"),"ransfer service is a style of API where a client makes HTTP requests to manipulate resources identified by the request URL. RESTful services are stateless, so no session state is stored on the server between requests. Each requests contains all the information needed to service that request."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Resource:"),"\nA ",(0,i.kt)("strong",{parentName:"p"},"resource")," is an object or concept that can be manipulated by the API. In our file storage example, they will be things like a 'Folder' and a 'File'. Resources are the building blocks of an API, the nouns in the language describing the system. All operations in the API manipulate the resources or their state. Resources should be organized in a way that is useful to the client. This is the most important part of the design of an API; if your resources just match your database schema one-to-one, chances are your API is not going to be very easy to use."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Representation:"),"\nREST APIs transfer ",(0,i.kt)("strong",{parentName:"p"},"representations")," of resources back and forth between the client and the service. These are documents that describe resources. Representations are most commonly JSON-formatted, but can be of any type."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Attribute:"),"\nRepresentations of resources consist of a series of ",(0,i.kt)("strong",{parentName:"p"},"attributes")," names and values as key-value pairs."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Collection:"),"\nA ",(0,i.kt)("strong",{parentName:"p"},"collection")," is a special kind of resource that represents a group of related resources. It contains a representation of each resource, and some additional information for things like pagination and filtering."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Identifier:"),"\nEvery resource in a collection MUST have an ",(0,i.kt)("strong",{parentName:"p"},"identifier")," attribute with a value that is unique within that collection."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Side Effects:"),"\nRequests that change the state of something in the service are said to have ",(0,i.kt)("strong",{parentName:"p"},"side effects"),". It is very important that certain types of requests not have side-effects."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Idempotent:"),"\nAn operation is ",(0,i.kt)("em",{parentName:"p"},"idempotent")," if it can be applied multiple times without changing the result after the first application."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Opaque:"),"\nSome pieces of information returned from a service are considered to be ",(0,i.kt)("strong",{parentName:"p"},"opaque"),'. Opaque values are a black box that has meaning only to the service; clients should not rely on any particular format, length, or content in an opaque value. They should not change the value or try to parse any meaning out of it. Opaque values MAY change between API revisions or even individual requests, so they should never be stored or compared against. For example, pagination URLs contain a "marker" attribute that identifies the appropriate page to load.'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Action:"),"\nAn ",(0,i.kt)("strong",{parentName:"p"},"action"),' is an operation that can be performed on a resource but does not fit into one the standard create/read/update/delete operations. For example "sharing" or "encrypting" a file resource.'),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Discoverability:"),"\n",(0,i.kt)("strong",{parentName:"p"},"Discoverability")," is a method of self-documenting. Each API has a collection of schemas that define what resource types are available and what attributes they have. Each response contains information about how to find related resources and what actions are available."),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"representations"},"Representations"),(0,i.kt)("p",null,"A representation is the way a resource is described/serialized in a HTTP request or response. All services MUST support:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"JSON (application/json) for both requests and responses.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This is the primary representation used by all APIs."))),(0,i.kt)("li",{parentName:"ul"},"HTML (text/html; charset=utf8) for responses",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This is a small HTML wrapper around the JSON format which presents the ",(0,i.kt)("a",{parentName:"li",href:"#html-ui"},"HTML UI"),"."),(0,i.kt)("li",{parentName:"ul"},"The HTML response format is only intended for use in a web browser, not for clients to parse."))),(0,i.kt)("li",{parentName:"ul"},"Forms (",(0,i.kt)("a",{parentName:"li",href:"http://tools.ietf.org/html/rfc2388"},"multipart/form-data")," and ",(0,i.kt)("a",{parentName:"li",href:"http://www.w3.org/TR/html401/interact/forms.html#form-content-type"},"application/x-www-form-urlencoded"),") for requests.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"These are needed for the ",(0,i.kt)("a",{parentName:"li",href:"#html-ui"},"HTML UI")," and are easy to create with browsers and command-line tools like cURL.")))),(0,i.kt)("p",null,"Services MAY support other representations that make sense for the particular application. These will be defined in the service documentation which a client can specify by sending the value in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Accept")," header of the request."),(0,i.kt)("p",null,"The representation is returned in the ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," header of the response."),(0,i.kt)("h2",{id:"dates"},"Dates"),(0,i.kt)("p",null,"Dates MUST be represented as an ",(0,i.kt)("a",{parentName:"p",href:"http://www.w3.org/TR/NOTE-datetime"},"ISO-8601")," formatted string."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'If a time component is included, a time zone designator MUST BE included and SHOULD always be UTC ("Z").'),(0,i.kt)("li",{parentName:"ul"},'If you have a very good reason to use something other than UTC, the attribute name SHOULD indicate that it is "local", "user", or similar to avoid confusion.'),(0,i.kt)("li",{parentName:"ul"},'e.g. "birthday": "1982-02-24", "created": "2012-09-27T18:39:53Z", "yourLocalTime": "2013-09-27T11:30:42-07:00"')),(0,i.kt)("h2",{id:"format"},"Format"),(0,i.kt)("p",null,"Clients MAY request a preferred representation by including an appropriate ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.1"},"Accept")," header."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Service SHOULD be lenient in mapping this to one of their acceptable formats."),(0,i.kt)("li",{parentName:"ul"},"For example ",(0,i.kt)("inlineCode",{parentName:"li"},"application/json"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"text/json;charset=utf-8"),", and ",(0,i.kt)("inlineCode",{parentName:"li"},"text/json")," can all be interpreted as JSON.")),(0,i.kt)("p",null,"If the request is from a web browser, the response SHOULD be HTML."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'The suggested definition of "a web browser" is that the Accept header contains "',"*","/","*",'" and the User-Agent header contains (case-insensitive) "mozilla".'),(0,i.kt)("li",{parentName:"ul"},"This matches all the common graphical web browsers but not HTTP request libraries or command-line browsers.")),(0,i.kt)("p",null,"When clients are sending a representation to the service (e.g. creating a resource), they MUST specify the format using the ","[Content-Type]","(",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.17"},"http://tools.ietf.org/html/rfc2616#section-14.17")," Content-Type) header."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If the service does not support the specified Content-Type, it SHOULD return a 406 error.")),(0,i.kt)("h2",{id:"special-headers"},"Special Headers"),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"X-API-Schemas:")," header MUST be present in all responses. The value tells the client the URI where they can find the collection of schemas to understand your responses."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The URI SHOULD be for the particular ",(0,i.kt)("a",{parentName:"li",href:"#api-versioning"},"API version")," the request is for."),(0,i.kt)("li",{parentName:"ul"},"If the request is for the ",(0,i.kt)("a",{parentName:"li",href:"#root-level"},"root level"),", it SHOULD be for the latest version.")),(0,i.kt)("h2",{id:"special-characters"},"Special Characters"),(0,i.kt)("p",null,'Escaping the forward slash ("/") character is not required by the ',(0,i.kt)("a",{parentName:"p",href:"http://json.org/"},"JSON specification"),", but requires consideration."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"When responding as JSON, slashes SHOULD NOT be escaped."),(0,i.kt)("li",{parentName:"ul"},'When responding as HTML, strings in the JSON data portion MUST have forward slashes escaped, typically as "\\/".',(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},'Failure to do this exposes the page to an XSS attack (using strings that contain "',"<","/script",">",'").')))),(0,i.kt)("h2",{id:"html-ui"},"HTML UI"),(0,i.kt)("p",null,"Services provide a HTML version of their API by wrapping the JSON response with the snippet below. It includes JavaScript and CSS that pretty-prints the response and displays a bar that provides buttons for operations, actions, sorting, filtering, pagination, etc."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n\x3c!-- If you are reading this, there is a good chance you would prefer sending an\n"Accept: application/json" header and receiving actual JSON responses. --\x3e\n<link\n  rel="stylesheet"\n  type="text/css"\n  href="//cdn.rancher.io/api-ui/1.0.0/ui.css"\n/>\n<script src="//cdn.rancher.io/api-ui/1.0.0/ui.js"><\/script>\n<script>\n  var schemas = \'http://url-to-your-api/v1/schemas\';\n  var data = {\n    /* ... JSON response ... */\n  };\n<\/script>\n')),(0,i.kt)("p",null,"There are several other options you can set to configure the UI. The full source is available in ",(0,i.kt)("a",{parentName:"p",href:"http://github.com/rancher/api-ui"},"rancher/api-ui"),", see it if you''d like to compile and host it yourself or to learn about the options."),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"authentication"},"Authentication"),(0,i.kt)("p",null,"Most APIs that do something useful will need some form of authentication to determine what user is making the request and validate that they should be allowed to make it. A user is identified by a set of credentials called an API Key pair."),(0,i.kt)("h3",{id:"api-keys"},"API Keys"),(0,i.kt)("p",null,"An API Key consists of a pair of strings called an ",(0,i.kt)("strong",{parentName:"p"},"access key")," and ",(0,i.kt)("strong",{parentName:"p"},"secret key"),". These are randomly generated opaque strings assigned by the service to each API user. The access key is analogous to a username and the secret key to a password."),(0,i.kt)("h3",{id:"http-basic"},"HTTP Basic"),(0,i.kt)("p",null,"Services MUST support ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2617#section-2"},"HTTP Basic")," authentication. In Basic authentication, the client sends their access key and secret key in the Authorization header. The service then reads these and validates the keys."),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"status-codes"},"Status Codes"),(0,i.kt)("p",null,"Every HTTP response contains a ",(0,i.kt)("strong",{parentName:"p"},"status code")," and is the primary indicator of the success of a request. Requests that were successfully handled MUST return a response with a 2xx (Success) or 3xx (Redirection) status code. Requests that cannot be processed MUST return a 4xx (Client Error) or 5xx (Server Error) code. It is important that these codes be applied correctly and consistently."),(0,i.kt)("p",null,"With over 70 HTTP Status Codes defined by ",(0,i.kt)("a",{parentName:"p",href:"http://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml"},"IANA"),", it is difficult to remember all of them. To address this a simple rule must be followed: Use HTTP Status Codes if they apply completely."),(0,i.kt)("p",null,"If there is any question, use a more generic status, such as a 400 or 500, describing the condition in detail following ",(0,i.kt)("a",{parentName:"p",href:"#errors"},"Error")," guidelines. For more information on when to use specific codes consult ",(0,i.kt)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/HTTP_status_code"},"Wikipedia")," or ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-10"},"RFC 2616"),"."),(0,i.kt)("p",null,"HTTP Status Codes come in five categories that identify their meaning:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"1xx: Informational - Request was received, more information was returned."),(0,i.kt)("li",{parentName:"ul"},"2xx: Success - The request was successfully received, understood and accepted."),(0,i.kt)("li",{parentName:"ul"},"3xx: Redirection - The request must be performed elsewhere to be completed."),(0,i.kt)("li",{parentName:"ul"},"4xx: Client Error - The request contained invalid information that the ",(0,i.kt)("strong",{parentName:"li"},"client")," must address. Attempting the same request will result in the same error."),(0,i.kt)("li",{parentName:"ul"},"5xx: Server Error - The request could not be fulfilled by the ",(0,i.kt)("strong",{parentName:"li"},"server"),". The same request may succeed (or produce a 4xx error) if attempted later.")),(0,i.kt)("h2",{id:"core-codes"},"Core Codes"),(0,i.kt)("p",null,"At a minimum the following HTTP Status Codes should be well known and used."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Code"),(0,i.kt)("th",{parentName:"tr",align:null},"Meaning"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"200 OK"),(0,i.kt)("td",{parentName:"tr",align:null},"The request was successful")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"201 Created"),(0,i.kt)("td",{parentName:"tr",align:null},"Success, and a new resource has been created. A Location header to the resource SHOULD be included.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"202 Accepted"),(0,i.kt)("td",{parentName:"tr",align:null},"The request has been received but has not completed. See ",(0,i.kt)("a",{parentName:"td",href:"#asynchronous-actions"},"Asynchronous Actions"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"400 Bad Request"),(0,i.kt)("td",{parentName:"tr",align:null},"The request was malformed in some way. Used for general errors that can be corrected by the client.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"401 Unauthorized"),(0,i.kt)("td",{parentName:"tr",align:null},"Authentication information was not sent or is invalid.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"403 Forbidden"),(0,i.kt)("td",{parentName:"tr",align:null},"The authenticated user is not allowed access to the requested resource.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"404 Not Found"),(0,i.kt)("td",{parentName:"tr",align:null},"These are not the droids you are looking for.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"422 Unprocessable Entity"),(0,i.kt)("td",{parentName:"tr",align:null},"The request was well-formed (400) and in a supported format (415), but cannot be processed. Typically used for application-specific validation errors.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"500","\xa0","Internal","\xa0","Server","\xa0","Error"),(0,i.kt)("td",{parentName:"tr",align:null},"A generic message for an error on the server. The client should try their request again later at which point it ",(0,i.kt)("strong",{parentName:"td"},"may")," succeed (or produce a 4xx error).")))),(0,i.kt)("h2",{id:"extended-codes"},"Extended Codes"),(0,i.kt)("p",null,"The remaining HTTP Status Codes will be used under certain specific circumstances."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Code"),(0,i.kt)("th",{parentName:"tr",align:null},"Meaning"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"301 Moved Permanently"),(0,i.kt)("td",{parentName:"tr",align:null},"Permanent redirect. The requested resource has moved ",(0,i.kt)("strong",{parentName:"td"},"permanently")," and clients should never request this URI again. If in doubt, use a 302.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"302 Found"),(0,i.kt)("td",{parentName:"tr",align:null},"Temporary redirect. The requested resource has moved and clients should request this URI again for future requests.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"304 Not Modified"),(0,i.kt)("td",{parentName:"tr",align:null},"The client requested a resource that allows a previous version to be used. No response will be sent.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"405 Method Not Allowed"),(0,i.kt)("td",{parentName:"tr",align:null},"The requested HTTP method is not allowed for this URL.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"406 Not Acceptable"),(0,i.kt)("td",{parentName:"tr",align:null},"The service does not support the representation that the client ",(0,i.kt)("strong",{parentName:"td"},"requested"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"409 Conflict"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"#resource-versioning"},"Resource versioning")," is enabled, and the requested operation conflicts with the current state.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"410 Gone"),(0,i.kt)("td",{parentName:"tr",align:null},"The resource requested has left. It will not come back.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"413 Entity Too Large"),(0,i.kt)("td",{parentName:"tr",align:null},"The request body is larger than the service is willing to process.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"414 Request-URI Too Long"),(0,i.kt)("td",{parentName:"tr",align:null},"The requested URL is longer than is accepted by the service.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"415 Unsupported Media Type"),(0,i.kt)("td",{parentName:"tr",align:null},"The service does not support the representation type that the client ",(0,i.kt)("strong",{parentName:"td"},"sent"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"418 I'm a teapot"),(0,i.kt)("td",{parentName:"tr",align:null},"The request attempted to brew coffee with a teapot service that is not compliant with ",(0,i.kt)("a",{parentName:"td",href:"http://tools.ietf.org/html/rfc2324"},"RFC2324"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"503 Service Unavailable"),(0,i.kt)("td",{parentName:"tr",align:null},"The request couldn't be handled due to maintenance or overload.")))),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"resources"},"Resources"),(0,i.kt)("p",null,"Resource representations MUST have these attributes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"type:")," A string that uniquely identifies the kind, or type, of resource this is.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"The value MUST be the id of a ",(0,i.kt)("a",{parentName:"li",href:"#schemas"},"schema"),".")))),(0,i.kt)("p",null,"SHOULD have, in almost all cases:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"id:")," A string which uniquely identifies this resource. (See ",(0,i.kt)("a",{parentName:"li",href:"#identifiers"},"identifier")," design considerations)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"links:")," A map with ",(0,i.kt)("a",{parentName:"li",href:"#links"},"links")," to:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"self:")," The location of the resource itself."))),(0,i.kt)("li",{parentName:"ul"},"Other application-specific information attributes")),(0,i.kt)("p",null,"And MAY have, when appropriate:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Additional ",(0,i.kt)("inlineCode",{parentName:"li"},"links:")," entries for related resources and collections."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"actions:")," A map of ",(0,i.kt)("a",{parentName:"li",href:"#actions"},"action")," names ","\u2192"," the URL that is used to invoke them.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "id":      "b1b2e7006be",\n  "type":    "file",\n  "links":   { /* see links */ },\n  "actions": { /* see actions */ },\n  "name":    "ultimate_answer.txt",\n  "size":    2,\n  /* ...  more application-specific attributes ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"collections"},"Collections"),(0,i.kt)("p",null,'Collections are a special kind of resource. They have a "data" array that contains an array of resources.'),(0,i.kt)("p",null,"Collection representations MUST have:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"type:"),' "collection"'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"resourceType:")," The id of the ",(0,i.kt)("a",{parentName:"li",href:"#schemas"},"schema")," for the type of resource this collection holds."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"data:")," An array containing resource representations",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This MUST always be present and be an array, even if there are 0 or 1 entries in it.")))),(0,i.kt)("p",null,"SHOULD have, in almost all cases:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"links:")," A map with ",(0,i.kt)("a",{parentName:"li",href:"#links"},"links")," to:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"self:")," The location of the resource itself.")))),(0,i.kt)("p",null,"And MAY have, when appropriate:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Additional ",(0,i.kt)("inlineCode",{parentName:"li"},"links:")," entries for related resources and collections."),(0,i.kt)("li",{parentName:"ul"},"Additional application-specific attributes (on the collection, as it is itself a resource)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"actions:")," A map of action names ","\u2192"," the URL that can be requested to perform them (on the collection)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"pagination:")," See ",(0,i.kt)("a",{parentName:"li",href:"#pagination"},"pagination"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sort:")," See ",(0,i.kt)("a",{parentName:"li",href:"#sorting"},"sorting"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"filters:")," See ",(0,i.kt)("a",{parentName:"li",href:"#filtering"},"filtering"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"createDefaults:")," A map of field names ","\u2192"," their values.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This values provide a context-specific default value for fields which a client MAY use when creating a new resource in the collection."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"createTypes:")," See inheritance, below.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "type": "collection",\n  "resourceType": "file",\n  "links": {\n    "self":     "https://base/v1/files",\n    /* ... more links ... */\n  },\n  "actions":    { /* see actions */ },\n  "pagination": { /* see pagination */ },\n  "sort":       { /* see sorting */ },\n  "filters":    { /* see filtering */ },\n  "data": [\n    {/* file resource */},\n    {/* file resource */},\n    /* ... more resources ... */\n  ],\n  /* ... application-specific attributes ... */\n}\n')),(0,i.kt)("h3",{id:"inheritance"},"Inheritance"),(0,i.kt)("p",null,"Collections MAY support multiple resource types through simple inheritance:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"resourceType:")," SHOULD refer to the 'base' resource type."),(0,i.kt)("li",{parentName:"ul"},"Define additional sub-types that have all the same fields and filters as the base type, plus additional info."),(0,i.kt)("li",{parentName:"ul"},"Return a ",(0,i.kt)("inlineCode",{parentName:"li"},"createTypes:")," map in the collection, with a mapping of type ids that can be created ","\u2192"," the URL where they SHOULD be POSTed.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"If the 'base' type can also be created, it SHOULD be present in the map."),(0,i.kt)("li",{parentName:"ul"},"The URL for each entry MAY be the same as the collection's self link, or it can be different to provide additional flexibility in the service.")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'  "createTypes": {\n    "file":      "https://base/v1/files",\n    "textFile":  "https://base/v1/files",\n    "imageFile": "https://base/v1/files?image=1",\n  },\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"errors"},"Errors"),(0,i.kt)("p",null,"Error responses MUST be a valid ",(0,i.kt)("a",{parentName:"p",href:"#resources"},"resource")," which gives more information about the error. At a minimum, they MUST include:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"type:"),' "error"'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"status:")," the HTTP status code of the response"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"code:")," A short identifier for the error, suitable for identifying what specific kind of error this is within client code.")),(0,i.kt)("p",null,"Errors SHOULD include:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"message:")," A short description of the error suitable for a human ",(0,i.kt)("strong",{parentName:"li"},"developer")," to read."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"detail:")," Additional more detailed information, if available.")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"type"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"status"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"code"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"message")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"detail")," are intended for developer use only and SHOULD NOT be presented directly the end-user. Client SHOULD use the ",(0,i.kt)("inlineCode",{parentName:"p"},"status")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"code")," to construct their own meaningful message for end-user consumption."),(0,i.kt)("p",null,"Error responses MUST be returned in the representation format that the client asked for. If the service cannot cater to the representation requested a 406 Status Code should be returned."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It is rude to send an HTML error page back to a client that made a request for JSON."),(0,i.kt)("li",{parentName:"ul"},"Consider responses that might be returned from application servers and web proxies within your stack."),(0,i.kt)("li",{parentName:"ul"},"Respond with no body if it is not possible to respond in the correct format, or if an error occurs within ",(0,i.kt)("a",{parentName:"li",href:"#format"},"content negotiation"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "type":    "error",\n  "status":  404,\n  "code":    "FolderNotFound",\n  "message": "The specified folder does not exist",\n  "folderName": "Documents",\n  /* ... more application-specific info ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"links"},"Links"),(0,i.kt)("p",null,"Links provide a trail for the client to follow to get to related information that is not included in the response."),(0,i.kt)("p",null,"Clients"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"SHOULD use the links provided to navigate resources."),(0,i.kt)("li",{parentName:"ul"},"SHOULD NOT hard-code or string-concatenate URLs (other than the version root).")),(0,i.kt)("p",null,"Services"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"SHOULD provide all appropriate links to that a client can get to anything exclusively by navigating resource links."),(0,i.kt)("li",{parentName:"ul"},"SHOULD strive to keep URL layout stable, as clients may save link values and expect to be able to retrieve them later."),(0,i.kt)("li",{parentName:"ul"},"MAY alter URL layout and link values, if necessary.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This is not considered a ",(0,i.kt)("a",{parentName:"li",href:"#api-versioning"},"breaking change"),", but the Service SHOULD redirect old URLs to the new ones.")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "links": {\n    "self":     "https://base/v1/files/b1b2e7006be",\n    "content":  "https://base/v1/files/b1b2e7006be/content",\n    "folder":   "https://base/v1/folders/19c3932wef",\n    "public":   "http://documents.your-files.com/ultimate_answer.txt"\n    /* ... more links ... */\n  },\n  /* ...other attributes... */\n}\n')),(0,i.kt)("p",null,'Link entries SHOULD lead to a valid destination. For example, if you know a resource has no "public" URL because it is not shared, do not include the "public" attribute.'),(0,i.kt)("p",null,"See also: ",(0,i.kt)("a",{parentName:"p",href:"#what-to-link"},"What to link")),(0,i.kt)("h3",{id:"construction"},"Construction"),(0,i.kt)("p",null,"Link values are strings and MUST be an absolute URL, including the scheme, host, port, and ",(0,i.kt)("a",{parentName:"p",href:"#api-versioning"},"API Version"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"This prevents the client needing resolve relative URLs into absolute ones."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"#compression"},"HTTP compression")," makes the overhead of transmitting absolute vs relative URLs negligible."),(0,i.kt)("li",{parentName:"ul"},"Port SHOULD be omitted if it is the default for the scheme (e.g. 443 for https).")),(0,i.kt)("p",null,"Handling forward slashes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Trailing slashes SHOULD NOT be included on URLs produced by a service."),(0,i.kt)("li",{parentName:"ul"},"SHOULD have no effect on the response if a client sends one."),(0,i.kt)("li",{parentName:"ul"},"Multiple slashes in a URL SHOULD be treated as a single slash.")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"schemas"},"Schemas"),(0,i.kt)("p",null,'Each service MUST have a top-level collection called "schemas" which contains "schema" resource for each resource type. The information contained in the schemas provides enough information to build a smart client that knows what actions are available, what fields make up a resource, etc.'),(0,i.kt)("p",null,'The "schemas" collection MUST also have a link to the base URL of the API version.'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"This makes the schema collection (https://base/v1/schemas) a single URL that provides a client everything they need to know about the service, similar to a WSDL in a SOAP service.")),(0,i.kt)("p",null,"Each schema resource MUST describe:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"id:"),': The name of the resource type (e.g. "folder").'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"type:"),' "schema"'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"links:"),":",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"self:"),': The URL for this schema (e.g. "https://base/v1/schemas/folder")'),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collection:"),' If this type can be queried/listed, the URL for doing so (e.g. "http://base/v1/folders").',(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This SHOULD correspond to the collections that are linked at the ",(0,i.kt)("a",{parentName:"li",href:"#version-root"},"version root"),"."),(0,i.kt)("li",{parentName:"ul"},"This link is used by API clients to generate object stubs as the URL to fetch data from."),(0,i.kt)("li",{parentName:"ul"},"This link is used by the ",(0,i.kt)("a",{parentName:"li",href:"#html-ui"},"HTML UI")," to provide a dropdown of choices for fields that are of type reference."))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"resourceFields:"),": A map of attribute names available in ",(0,i.kt)("strong",{parentName:"li"},"resources")," of this type ","\u2192"," descriptions of that field (see ",(0,i.kt)("a",{parentName:"li",href:"#schema-fields"},"fields"),").")),(0,i.kt)("p",null,"And SHOULD describe if applicable:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"resourceMethods:"),": An array of HTTP methods that are available to some (but not necessarily all) ",(0,i.kt)("strong",{parentName:"li"},"resources")," of this type."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"resourceActions:"),": A map detailing the actions available to ",(0,i.kt)("strong",{parentName:"li"},"resources")," of this type (see ",(0,i.kt)("a",{parentName:"li",href:"#actions"},"actions"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collectionMethods:"),": An array of HTTP methods that are available to a ",(0,i.kt)("strong",{parentName:"li"},"collection")," of this type."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collectionActions:"),": A map detailing the actions available to ",(0,i.kt)("strong",{parentName:"li"},"collections")," of this type (see ",(0,i.kt)("a",{parentName:"li",href:"#actions"},"actions"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collectionFields:"),": A map detailing the non-standard attribute fields that the ",(0,i.kt)("strong",{parentName:"li"},"collection")," has. (see ",(0,i.kt)("a",{parentName:"li",href:"#schema-fields"},"fields"),")."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collectionFilters:"),": A map detailing the filters that are available to ",(0,i.kt)("strong",{parentName:"li"},"collections")," of this type (see ",(0,i.kt)("a",{parentName:"li",href:"#filtering"},"filters"),").")),(0,i.kt)("h2",{id:"schema-fields"},"Schema Fields"),(0,i.kt)("p",null,"Each field is defined by a map of properties. Fields MUST have a ",(0,i.kt)("inlineCode",{parentName:"p"},"type:"),', which may be a "simple" type:'),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"type"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"string"'),(0,i.kt)("td",{parentName:"tr",align:null},"UTF-8 string")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"multiline"'),(0,i.kt)("td",{parentName:"tr",align:null},"Same as string, but hint to the client that the string may have multiple lines (for HTML: ",(0,i.kt)("inlineCode",{parentName:"td"},"<textarea>"),")")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"masked"'),(0,i.kt)("td",{parentName:"tr",align:null},"Same as string, but hint to the client that they should mask display of the text (for HTML: ",(0,i.kt)("inlineCode",{parentName:"td"},'<input type="password">'),")")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"password"'),(0,i.kt)("td",{parentName:"tr",align:null},"Same as masked, but hint to the client to additionally offer a password generator")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"float"'),(0,i.kt)("td",{parentName:"tr",align:null},"JSON uses double-precision ",(0,i.kt)("a",{parentName:"td",href:"http://en.wikipedia.org/wiki/IEEE_floating_point"},"IEEE 754"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"int"'),(0,i.kt)("td",{parentName:"tr",align:null},'"int"s are just floats in JSON, so the min/max safe values are ',"\xb1"," 2",(0,i.kt)("sup",null,"53"),". Other clients may use signed 32-bit integers, so be careful with any values that may approach 2",(0,i.kt)("sup",null,"31"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"date"'),(0,i.kt)("td",{parentName:"tr",align:null},"As a string, see ",(0,i.kt)("a",{parentName:"td",href:"#dates"},"dates"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"blob"'),(0,i.kt)("td",{parentName:"tr",align:null},"Binary data, encoded as a string")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"boolean"'),(0,i.kt)("td",{parentName:"tr",align:null},"Boolean")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"json"'),(0,i.kt)("td",{parentName:"tr",align:null},"Arbitrary JSON-parseable string. You should feel bad about using this, but sometimes a field really isn't strongly-typed.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"version"'),(0,i.kt)("td",{parentName:"tr",align:null},"Semantic version string.")))),(0,i.kt)("p",null,"Or a non-simple type:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"type"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"enum"'),(0,i.kt)("td",{parentName:"tr",align:null},"One choice out of an enumeration of possible values")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"reference',"[",(0,i.kt)("inlineCode",{parentName:"td"},"schema_name"),"]",'"'),(0,i.kt)("td",{parentName:"tr",align:null},"The value is the id of a resource of type ",(0,i.kt)("inlineCode",{parentName:"td"},"schema_name"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"',(0,i.kt)("inlineCode",{parentName:"td"},"schema_name"),'"'),(0,i.kt)("td",{parentName:"tr",align:null},"The value is the representation of a resource of type ",(0,i.kt)("inlineCode",{parentName:"td"},"schema_name"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"array',"[",(0,i.kt)("inlineCode",{parentName:"td"},"another_type"),"]",'"'),(0,i.kt)("td",{parentName:"tr",align:null},"The value is an array of entries of type ",(0,i.kt)("inlineCode",{parentName:"td"},"another_type"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},'"map',"[",(0,i.kt)("inlineCode",{parentName:"td"},"another_type"),"]",'"'),(0,i.kt)("td",{parentName:"tr",align:null},"Key/value pairs. Keys are strings, Values are of type ",(0,i.kt)("inlineCode",{parentName:"td"},"another_type"))))),(0,i.kt)("p",null,"Additional metadata SHOULD be provided for each field when applicable:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"name"),(0,i.kt)("th",{parentName:"tr",align:null},"type"),(0,i.kt)("th",{parentName:"tr",align:null},"description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"default:")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"same as field")),(0,i.kt)("td",{parentName:"tr",align:null},"The default value that will be used if none is specified")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"unique:")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"If true, this field's value must be unique with its resource type")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"nullable:")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"If true, null is a valid value for this field")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"create:")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"If true, this the field can be set when creating a resource")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"required:")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"If true, this field must be set when creating a resource")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"update:")),(0,i.kt)("td",{parentName:"tr",align:null},"boolean"),(0,i.kt)("td",{parentName:"tr",align:null},"If true, this field's value can be changed when updating a resource")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"minLength:")),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"For strings and arrays, the minimum length (inclusive)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"maxLength:")),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"For strings and arrays, the maximum length (inclusive)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"min:")),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"For ints and floats, the minimum allowed value (inclusive)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"max:")),(0,i.kt)("td",{parentName:"tr",align:null},"int"),(0,i.kt)("td",{parentName:"tr",align:null},"For ints and floats, the maximum allowed value (inclusive)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"options:")),(0,i.kt)("td",{parentName:"tr",align:null},"array","[",(0,i.kt)("inlineCode",{parentName:"td"},"same as field"),"]"),(0,i.kt)("td",{parentName:"tr",align:null},"For enums, the list of possible values")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"validChars:")),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"For strings, only these characters are allowed (see ",(0,i.kt)("a",{parentName:"td",href:"#character-ranges"},"character ranges"),")")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"invalidChars:")),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"For strings, these characters are not allowed (see ",(0,i.kt)("a",{parentName:"td",href:"#character-ranges"},"character ranges"),")")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"referenceCollection:")),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"For references, a query URL that can be used to find valid resources of the reference type")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"satisfies:")),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"For versions, a semver range which the version must satisfy")))),(0,i.kt)("h3",{id:"field-validation"},"Field Validation"),(0,i.kt)("p",null,"The additional fields above provide enough info for a client to do basic validation of values before submitting them to a service. They are not intended to be completely comprehensive; A service will often have additional restrictions on values that cannot be represented here. If the service is given a value that does not match all of its conditions, it should return a 422 error with enough detail for the client to fix the problem and re-submit the request."),(0,i.kt)("h3",{id:"character-ranges"},"Character Ranges"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"validChars:")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"invalidChars:"),' are case-sensitive and may contain ranges as in a simple regular expression. For example alphanumeric strings may be represented as "a-zA-Z0-9". Unicode characters should be represented as ',(0,i.kt)("inlineCode",{parentName:"p"},"\\uXXXX")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"\\uXXXXXX"),", where X are the hexadecimal representation of the codepoint."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "id": "file",\n  "type": "schema",\n  "resourceMethods": ["GET","DELETE"],\n  "resourceFields": {\n    "name":   {"type": "string", "required": true, "create": true, "update": true},\n    "size":   {"type": "int"},\n    "owner":  {"type": "reference[user]"},\n    "access": {\n      "type":    "enum",\n      "options": ["public","private","requirepassword"],\n      "default": "private",\n      "create":  true,\n      "update":  true\n    },\n    /* ... more fields ... */\n  },\n  "resourceActions": {\n    "encrypt": {\n      "input":  "cryptInput",\n      "output": "file",\n    },\n    /* ...more actions... */\n  },\n  "collectionMethods": ["GET","POST"],\n  "collectionActions": {\n    "archive" {\n      "input":  "archiveInput",\n      "output": "file",\n    }\n    /* ...more actions... */\n  },\n  "collectionFields": {\n    "size": {"type": "int"}\n  },\n  "collectionFilters": {\n    "name":   {"modifiers": ["ne","prefix","suffix"]},\n    "date":   {"modifiers": ["lt","gt","lte","gte","prefix"]}\n    "size":   {"modifiers": ["lt","gt","lte","gte"] }\n    "access": {"modifiers": ["eq","ne"], "options": ["public","private","requirepassword"]}\n  }\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"actions"},"Actions"),(0,i.kt)("p",null,"Actions perform an operation on a resource and (optionally) return a result. They may take an input resource and typically do something that requires application logic beyond what could be done with a simple ",(0,i.kt)("a",{parentName:"p",href:"#create-operation"},"create"),", ",(0,i.kt)("a",{parentName:"p",href:"#update-operation"},"update"),", or ",(0,i.kt)("a",{parentName:"p",href:"#delete-operation"},"delete")," operation."),(0,i.kt)("p",null,"Types that have actions available have an ",(0,i.kt)("inlineCode",{parentName:"p"},"actions:")," and/or ",(0,i.kt)("inlineCode",{parentName:"p"},"collectionActions:"),' map in their schema detailing all the actions that are possible and their input/output schema. For example a file resource may have "share", "encrypt", and "decrypt" actions. See ',(0,i.kt)("a",{parentName:"p",href:"#schemas"},"schemas")," for more information."),(0,i.kt)("h2",{id:"in-resources"},"In Resources"),(0,i.kt)("p",null,"Resources have a ",(0,i.kt)("inlineCode",{parentName:"p"},"actions:"),' attribute that details what actions are available for this particular resource, and what URL is to be accessed to perform them. For example if only one of "encrypt" and "decrypt" are possible for a given file, only the one currently available would appear in the resource:'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "id": "b1b2e7006be",\n  "type": "file",\n  "actions": {\n    "share":   "https://base/v1/files/b1b2e7006be?share",\n    "encrypt": "https://base/v1/files/b1b2e7006be?encrypt"\n  },\n  /* ... other resource attributes ... */\n}\n')),(0,i.kt)("p",null,"Action URLs MUST be considered opaque strings to the client. A simple query parameter is suggested, but services may construct URLs in any format they desire. Examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'"https://base/v1/files/b1b2e7006be?encrypt"'),(0,i.kt)("li",{parentName:"ul"},'"https://base/v1/files/b1b2e7006be?action=encrypt"'),(0,i.kt)("li",{parentName:"ul"},'"https://base/v1/files/b1b2e7006be/encrypt"'),(0,i.kt)("li",{parentName:"ul"},'"https://base/v1/actions/encryptFile/b1b2e7006be"')),(0,i.kt)("h2",{id:"in-schema"},"In Schema"),(0,i.kt)("p",null,"Actions are defined by a map with 2 attributes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"input:")," The ID of the schema that the inputs will conform to"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"output:")," The ID of the schema that the outputs will conform to")),(0,i.kt)("p",null,"Inputs and outputs are resources and MUST have an associated schema. If the action takes no input or has no output, the appropriate attribute SHOULD be omitted."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "id":      "file",\n  "type":    "schema",\n  "resourceActions": {\n    "share": {\n      "input": "shareInput",\n    },\n    "decrypt": {\n      "input": "cryptInput",\n      "output": "file",\n    },\n    "encrypt": {\n      "input": "cryptInput",\n      "output": "file",\n    },\n    /* ... other actions ... */\n  },\n  /* ... other schema attributes ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"operations"},"Operations"),(0,i.kt)("p",null,"Operations are logical actions with their corresponding HTTP Methods, or Verbs. These operations are listed below and described in detail further below that."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Operation"),(0,i.kt)("th",{parentName:"tr",align:null},"HTTP Method"),(0,i.kt)("th",{parentName:"tr",align:null},"Request URL"),(0,i.kt)("th",{parentName:"tr",align:null},"Description")))),(0,i.kt)("h1",{id:"query-operation"},"Query Operation"),(0,i.kt)("p",null,"The query operation allows a client to list the resources that are in a collection. Query operations MUST NOT incur side effects."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/folders HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "type": "collection",\n  "resourceType": "folder",\n  "links": {\n    "self":    "https://base/v1/folders",\n    /* ... more links ... */\n  },\n  "data": [\n    {\n      "type":    "folder",\n      "id":      "b1b2e7006be",\n      "name":    "Documents",\n      "links":   { /* see links */ },\n      "actions": { /* see actions */ }\n    },\n    /* ... more folder resources ... */\n  ],\n  "actions": {\n    "deleteAll": "https://base/v1/folders?deleteAll",\n  },\n  "pagination": { /* see pagination */ },\n  "sort":       { /* see sorting */ },\n  "filters":    { /* see filtering */ }\n}\n')),(0,i.kt)("h3",{id:"pagination"},"Pagination"),(0,i.kt)("p",null,"Collections that may return a large number of results SHOULD paginate the response."),(0,i.kt)("p",null,"Pagination SHOULD be controlled by adding a ",(0,i.kt)("inlineCode",{parentName:"p"},"marker={opaque_string}")," query string parameter."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The implementation and meaning of the opaque string is left to the service."),(0,i.kt)("li",{parentName:"ul"},"A MySQL-style numerical offset is simple, but can return the same entry on 2 subsequent pages if the result set changes between requests."),(0,i.kt)("li",{parentName:"ul"},"A marker that specifically identifies the last row returned prevents this.")),(0,i.kt)("p",null,"Services SHOULD allow the client to specify how many results they would like per page with a ",(0,i.kt)("inlineCode",{parentName:"p"},"limit={integer}")," query string parameter."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The service SHOULD enforce (and document) an upper limit on how high this is allowed to go. At least 1000 is suggested."),(0,i.kt)("li",{parentName:"ul"},"Services SHOULD support ",(0,i.kt)("inlineCode",{parentName:"li"},"limit=0")," so that clients can get just the metadata for a collection (sort, filter, etc).")),(0,i.kt)("p",null,'If the collection supports pagination, the response MUST contain a "pagination" object containing:'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"limit:")," The number of items that are returned in each result set."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"partial:")," Whether this result is the complete set (true) or if it's been truncated (false).")),(0,i.kt)("p",null,"If the result has been truncated, it SHOULD also contain:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"first:")," The URL of a page containing the first resource in the result set (this SHOULD be the same URL, without a marker)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"previous:")," The URL of the page immediately preceding the current result set."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"next:")," The URL of the page immediately following the current result set.")),(0,i.kt)("p",null,"And MAY additionally contain:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"last:")," The page containing the last resource in the result set.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This may be impractical to implement, depending on your data source."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"total:")," The total number of items in the result set, if available.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"This may also be impractical, but is very useful information to a client if possible.")))),(0,i.kt)("p",null,"When the current result set contains the first resource, 'first' and 'previous' SHOULD NOT be returned.\nWhen the current result set contains the last resource, 'next' and 'last' SHOULD NOT be returned."),(0,i.kt)("p",null,"URLs included in this section SHOULD include all query parameters needed to maintain the current ",(0,i.kt)("a",{parentName:"p",href:"#sorting"},"sort")," and ",(0,i.kt)("a",{parentName:"p",href:"#filtering"},"filter"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  /* ... other collection attributes ... */\n  "pagination": {\n    "first":    "https://base/v1/files",\n    "previous": "https://base/v1/files?marker=opaque_string1",\n    "next":     "https://base/v1/files?marker=opaque_string2",\n    "last":     "https://base/v1/files?marker=opaque_string3",\n    "limit":    100,\n    "total":    342,\n    "partial":  true\n  },\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("h3",{id:"sorting"},"Sorting"),(0,i.kt)("p",null,"Services MAY allow clients to request a sorted list of resources in a collection by adding ",(0,i.kt)("inlineCode",{parentName:"p"},"sort={sort name}")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"order={asc or desc}")," query string parameters to the request. Clients MAY use these directly when constructing their query, but SHOULD use the links contained in results."),(0,i.kt)("p",null,"If a collection can be sorted, the response SHOULD contain a ",(0,i.kt)("inlineCode",{parentName:"p"},"sortLinks:")," object, a mapping of attributes that can be sorted ","\u2192"," the URL to produce that sort."),(0,i.kt)("p",null,"If the response was sorted by something, it SHOULD contain a ",(0,i.kt)("inlineCode",{parentName:"p"},"sort:")," object containing:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name:")," The name of the current sort, so that the client knows which column to show as sorted."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"order:")," The direction of the current sort. This SHOULD be either ",(0,i.kt)("inlineCode",{parentName:"li"},'"asc"')," or ",(0,i.kt)("inlineCode",{parentName:"li"},'"desc"'),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"reverse:")," The URL for the same sort in the opposite order.")),(0,i.kt)("p",null,"If no sort is specified by the client, services SHOULD either:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Choose a default, and include the ",(0,i.kt)("inlineCode",{parentName:"li"},"sort:")," attribute as if it were requested"),(0,i.kt)("li",{parentName:"ul"},"Or return results in an undefined/unstable order, with no ",(0,i.kt)("inlineCode",{parentName:"li"},"sort:")," attribute).")),(0,i.kt)("p",null,'Sorts MUST be "stable". This means they must produce a unique and repeatable ordering such that the same query will always return results in the same order.'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"This is necessary for ",(0,i.kt)("a",{parentName:"li",href:"#pagination"},"pagination"),", and is generally what a client would expect."),(0,i.kt)("li",{parentName:"ul"},'For example the "size" of a file is not unique, so the results should be sorted by something else to make it stable.'),(0,i.kt)("li",{parentName:"ul"},"A simple way to do this is to always sort by what the user wants, then by ID or unique name.")),(0,i.kt)("p",null,"URLs included in this section SHOULD include all parameters needed to maintain the current ",(0,i.kt)("a",{parentName:"p",href:"#filtering"},"filter"),", but SHOULD NOT include information about pagination. When following a link to a different sort order, the client SHOULD end up back on the first page of results again."),(0,i.kt)("p",null,"Multi-level sorting is not defined."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  /* ... other collection attributes ... */\n  "sort": {\n    "name":    "size",\n    "order":   "asc",\n    "reverse": "https://base/v1/files?sort=size&order=desc",\n  },\n  "sortLinks": {\n    "name":       "https://base/v1/files?sort=name",\n    "size":       "https://base/v1/files?sort=size",\n    "upload_date: "https://base/v1/files?sort=upload_date",\n    /* ... more sort options ... */\n  },\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("h3",{id:"filtering"},"Filtering"),(0,i.kt)("p",null,"Services MAY support searching/filtering of the collection. Support for this is indicated by ",(0,i.kt)("inlineCode",{parentName:"p"},"collectionFilters:")," in the schema, and the presence of a ",(0,i.kt)("inlineCode",{parentName:"p"},"filters:")," map in the collection response."),(0,i.kt)("h4",{id:"client-request"},"Client Request"),(0,i.kt)("p",null,"The client performs a search by starting with the URL for a standard query request. If they've already done a query and want to filter the results, the ",(0,i.kt)("inlineCode",{parentName:"p"},"self:")," link of the result can be used instead. The client then adds on query string parameters for ",(0,i.kt)("inlineCode",{parentName:"p"},'{filter name}{"_"+modifier}={value}'),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The underscore and modifier are optional if the desired modifier is ",(0,i.kt)("inlineCode",{parentName:"li"},"eq"),".",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name_eq=a")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"name=a")," are equivalent."))),(0,i.kt)("li",{parentName:"ul"},'For example to search for filenames starting with "a" and greater than 1kb, the client would append:',(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name_prefix=a&size_gt=1024")))),(0,i.kt)("li",{parentName:"ul"},"To search for non-image files, they could append:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name_notlike=%.jpg&name_notlike=%.png"))))),(0,i.kt)("p",null,"All special characters in filter values MUST be ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc3986#section-2.4"},"URL-encoded"),'.\nNote: "%" characters are shown here for clarity, but would be "%25" in an actual request.'),(0,i.kt)("p",null,"There is no mechanism defined for OR-ing conditions. All filters are AND-ed together."),(0,i.kt)("h4",{id:"collection-response"},"Collection Response"),(0,i.kt)("p",null,"Collections that support filtering SHOULD have a ",(0,i.kt)("inlineCode",{parentName:"p"},"filter:")," map in the response, with an attribute for each field that can be filtered on."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"If any filter was applied for that field, the value should be an array describing the filters."),(0,i.kt)("li",{parentName:"ul"},"If no filters were applied for that field, the value should be null.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  /* ... other collection attributes ... */\n  filters: {\n    name:   [ {"modifier": "prefix", "value":"a"  } ],\n    size:   [ {"modifier": "gt",     "value": 1024} ],\n    date:   null,\n    access: null\n    /* ... more filters ... */\n  }\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  /* ... other collection attributes ... */\n  filters: {\n    name: [\n      {"modifier": "notlike", "value": "%.jpg"},\n      {"modifier": "notlike", "value": "%.png"}\n    ],\n    size:   null,\n    date:   null,\n    access: null\n    /* ... more filters ... */\n  }\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("h4",{id:"schema"},"Schema"),(0,i.kt)("p",null,"In the schema, the value of each filter attribute SHOULD be an object describing:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"modifiers:")," What modifiers are supported, if any"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"options:")," What specific values are allowed, if the attribute is enumerable")),(0,i.kt)("p",null,'Modifiers allow things like "greater than" or "not equal to". The standard modifiers are:'),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"modifier"),(0,i.kt)("th",{parentName:"tr",align:null},"meaning"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"eq"')),(0,i.kt)("td",{parentName:"tr",align:null},"equal to",(0,i.kt)("br",null),"(always available, the default if no modifier is specified)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"ne"')),(0,i.kt)("td",{parentName:"tr",align:null},"not equal to")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"lt"')),(0,i.kt)("td",{parentName:"tr",align:null},"less than")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"lte"')),(0,i.kt)("td",{parentName:"tr",align:null},"less than or equal to")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"gt"')),(0,i.kt)("td",{parentName:"tr",align:null},"greater than")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"gte"')),(0,i.kt)("td",{parentName:"tr",align:null},"greater than or equal to")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"prefix"')),(0,i.kt)("td",{parentName:"tr",align:null},"starts with")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"like"')),(0,i.kt)("td",{parentName:"tr",align:null},"matches, as in SQL:",(0,i.kt)("br",null),"\u2022",' underscore ("',"_",'") for exactly one character',(0,i.kt)("br",null),"\u2022",' percent ("%") for 0 or more characters',(0,i.kt)("br",null),"\u2022",' "',"_",'" for one underscore character',(0,i.kt)("br",null),"\u2022",'"%" for one percent character.')),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"notlike"')),(0,i.kt)("td",{parentName:"tr",align:null},"does not match (as above)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"null"')),(0,i.kt)("td",{parentName:"tr",align:null},"value is NULL")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"notnull"')),(0,i.kt)("td",{parentName:"tr",align:null},"value is not NULL")))),(0,i.kt)("p",null,"Services MAY define (and document) their own modifiers."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  /* ... other collection attributes ... */\n  "collectionFilters": {\n    "name":   {"modifiers": ["eq","ne","prefix","suffix"]},\n    "date":   {"modifiers": ["eq","lt","gt","lte","gte","prefix"]}\n    "size":   {"modifiers": ["eq","lt","gt","lte","gte"] }\n    "access": {"modifiers": ["eq","ne"], "options": ["public","private","requirepassword"]}\n    /* ... more filters ... */\n  },\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"read-operation"},"Read Operation"),(0,i.kt)("p",null,"The read operation allows a client to get a single resource. Read operations MUST NOT incur side effects."),(0,i.kt)("h3",{id:"root-level"},"Root Level"),(0,i.kt)("p",null,"GETting the base URL of a service SHOULD return a collection of ",(0,i.kt)("inlineCode",{parentName:"p"},"apiVersion")," resources. It SHOULD include a link to the ",(0,i.kt)("inlineCode",{parentName:"p"},"latest:")," stable version of the API."),(0,i.kt)("p",null,"Versions that are not the latest MAY have a ",(0,i.kt)("inlineCode",{parentName:"p"},"deprecated: true")," flag to indicate support for this version will be removed in the near future."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n  "type": "collection",\n  "links": {\n    "self":   "https://base/",\n    "latest": "https://base/v3",\n  },\n  "data": [\n    {\n      "id":    "v1",\n      "type":  "apiVersion",\n      "deprecated": true,\n      "links": {\n        "self": "https://base/v1",\n        "file":    "https://base/v1/files",\n        "folder":  "https://base/v1/folders"\n        /* ... other collections and resources ... */\n      }\n    },\n    {\n      "id":    "v2",\n      "type":  "apiVersion",\n      "deprecated": false,\n      "links": {\n        "self": "https://base/v2"\n        "file":    "https://base/v2/files",\n        "folder":  "https://base/v2/folders"\n        /* ... other collections and resources ... */\n      }\n    },\n    {\n      "id":    "v3",\n      "type":  "apiVersion",\n      "deprecated": false,\n      "links": {\n        "self": "https://base/v3",\n        "file":    "https://base/v3/files",\n        "folder":  "https://base/v3/folders"\n        /* ... other collections and resources ... */\n      }\n    }\n  ]\n}\n')),(0,i.kt)("h3",{id:"version-root"},"Version Root"),(0,i.kt)("p",null,"GETting the root URL of a particular API version SHOULD return a resource containing links to all the collections and resources that are available. See ",(0,i.kt)("a",{parentName:"p",href:"#api-versioning"},"API Versioning")," for more info."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1 HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "id": "v1",\n  "type":  "apiVersion",\n  "deprecated": true,\n  "links": {\n    "self":    "https://base/v1",\n    "file":    "https://base/v1/files",\n    "folder":  "https://base/v1/folders"\n    /* ... other collections and resources ... */\n  },\n}\n')),(0,i.kt)("h3",{id:"individual-resource"},"Individual Resource"),(0,i.kt)("p",null,"GETting the URL of a resource SHOULD return the representation of that resource."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/files/b1b2e7006be HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "id": "b1b2e7006be",\n  "type": "file",\n  /* ... other resource attributes ... */\n}\n')),(0,i.kt)("h3",{id:"headers-only"},"Headers only"),(0,i.kt)("p",null,"Making a HEAD request to a URL SHOULD return the same response code and header information as a GET of the same URL would, except that it MUST NOT return any message body."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HEAD /v1/files/b1b2e7006be HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\nContent-Length: 234\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HEAD /v1/files/non-existent-id HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"HTTP/1.1 404 Not Found\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\nContent-Length: 123\n\n")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"create-operation"},"Create Operation"),(0,i.kt)("p",null,"The create operation allows a client to create a new resource in a collection."),(0,i.kt)("p",null,"The body of the request MUST contain a representation of the resource to be created. If any of the fields that are required by the schema for this resource are not included or are invalid, a 422 error SHOULD be returned, with information about what specifically is wrong."),(0,i.kt)("p",null,"If the created resource is immediately available, a 201 Created status code SHOULD be returned, and the body SHOULD be the representation of the new resource. If the resource cannot be created and read immediately, a 202 Accepted status SHOULD be returned instead. At least the resource id should be returned if at all possible."),(0,i.kt)("h3",{id:"single-resource"},"Single resource"),(0,i.kt)("p",null,"For a single resource, the response SHOULD include a ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.30"},"Location")," header with the URL for the new resource. This is likely the same as the ",(0,i.kt)("inlineCode",{parentName:"p"},"self:")," link in the resource. Note that Location headers MUST always be an absolute URL."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'POST /v1/folders HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n{\n  "name": "Documents"\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 201 Created\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\nLocation: https://base/v1/folders/ab391827x31\n\n{\n  "id":   "ab391827x31",\n  "type": "folder",\n  /* ... more resource attributes ... */\n}\n')),(0,i.kt)("h3",{id:"single-resource---form-post"},"Single resource - Form Post"),(0,i.kt)("p",null,"Services SHOULD also support create calls which are HTML Form encoded, ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type: multipart/form-data")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type: application/x-www-form-urlencoded"),". These are easy for a client to construct with a HTML form or cURL, and also allow for simple uploading of binary data/files. A file management API might allow creating a file resource like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -u access_key:secret_key \\\n  -F name="ultimate_answer.txt" \\\n  -F file="@mydatafile.txt" \\\n  "http://base/v1/folders/ab391827x31"\n')),(0,i.kt)("p",null,"Which would make a request like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'POST /v1/folders/ab391827x31 HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Length: 307\nContent-Type: multipart/form-data; boundary=----------------------------9a41916dd20a\n\n------------------------------9a41916dd20a\nContent-Disposition: form-data; name="name"\n\nultimate_answer.txt\n------------------------------9a41916dd20a\nContent-Disposition: form-data; name="file"; filename="mydatafile.txt"\nContent-Type: text/plain\n\n42\n------------------------------9a41916dd20a--\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 201 Created\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\nLocation: https://base/v1/files/b1b2e7006be\n\n{\n  "id":   "b1b2e7006be",\n  "type": "file",\n  /* ... more resource attributes ... */\n}\n')),(0,i.kt)("h3",{id:"multiple-resources"},"Multiple resources"),(0,i.kt)("p",null,"Services MAY allow multiple resources to be created in one request by accepting an array of representations instead of a single one."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A Location header SHOULD NOT be returned."),(0,i.kt)("li",{parentName:"ul"},"The response SHOULD be a collection containing the created resources."),(0,i.kt)("li",{parentName:"ul"},"The service MUST ensure that this operation is atomic:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Either ALL the creates succeed and a 2xx response code is returned,"),(0,i.kt)("li",{parentName:"ul"},"or NONE of the changes are committed and a 4xx or 5xx code is returned."),(0,i.kt)("li",{parentName:"ul"},"If this is not possible then the service SHOULD reject requests for multi-resource create with a 406 error.")))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'POST /v1/folders HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n[\n  {"name": "Documents", /* ... more resource attributes ... */},\n  {"name": "Pictures",  /*... more resource attributes ... */},\n  /* ... more resource representations ... */\n]\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 201 Created\nX-API-Schemas: https://base/v1/schemas\nContent-Type: application/json\n\n{\n  "type": "collection",\n  "resourceType": "folder",\n  "data": [\n    {"name": "Documents", /* ... more resource attributes ... */},\n    {"name": "Pictures",  /* ... more resource attributes ... */},\n    /* ... more resource representations ... */\n  ]\n  /* ... more collection attributes ... */\n}\n')),(0,i.kt)("h3",{id:"post-vs-put"},"POST vs. PUT"),(0,i.kt)("p",null,"When to use a POST over a PUT to create a resource is better described in an example. A POST would be used when the service generates an ID, where a PUT is used when a resource should be created at a specific location:"),(0,i.kt)("p",null,"A POST is used to create a resource that generates an ID:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"POST /v1/files HTTP/1.1\n")),(0,i.kt)("p",null,"A PUT is used to create a resource where the ID is known:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"PUT /v1/files/b1b2e7006be HTTP/1.1\n")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"update-operation"},"Update Operation"),(0,i.kt)("p",null,"The update operation allows a client to modify resources. Update operations MUST be idempotent; making the same update request again should have no effect."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Any change which does not have this property is an ",(0,i.kt)("a",{parentName:"li",href:"#action-operation"},"action"),", not an update.")),(0,i.kt)("p",null,"Clients may submit just the attributes that they wish to change, or the entire representation of a resource. The ",(0,i.kt)("inlineCode",{parentName:"p"},"id:"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"rev:"),"(if ",(0,i.kt)("a",{parentName:"p",href:"#resource-versioning"},"resource versioning")," is enabled) attributes MUST always be included."),(0,i.kt)("p",null,"The response SHOULD include the entire updated resource representation(s), even if the request did not. If the resource is a potentially large binary file instead of a JSON document, a 204 status and no response body SHOULD be returned."),(0,i.kt)("h3",{id:"single-resource-1"},"Single resource"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'PUT /v1/folders/b1b2e7006be HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n{\n  "id":     "b1b2e7006be",\n  "rev":    "8d2e54afd",\n  "access": "private"\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "id":     "b1b2e7006be",\n  "rev":    "8d2e54afd",\n  "name":   "Documents",\n  "access": "private"\n}\n')),(0,i.kt)("h3",{id:"multiple-resources-1"},"Multiple resources"),(0,i.kt)("p",null,"When updating multiple resources, the service MUST ensure that the operation is atomic."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Either ALL the changes succeed and a 2xx response code is returned,"),(0,i.kt)("li",{parentName:"ul"},"or NONE of the changes are committed and a 4xx or 5xx code is returned."),(0,i.kt)("li",{parentName:"ul"},"If this is not possible, do not allow multiple updates."),(0,i.kt)("li",{parentName:"ul"},"The service SHOULD document and limit the number of resources that may be updated in one request and return a 400 error if the limit is exceeded.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'PUT /v1/folders HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n[\n  {\n    "id":     "b1b2e7006be",\n    "rev":    "8d2e54afd",\n    "access": "private"\n  },\n  {\n    "id":     "d5a80ee7",\n    "type":   "folder",\n    "rev":    "9586f36z",\n    "name":   "Pictures",\n    "access": "public"\n  }\n]\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "type": "collection",\n  "resourceType": "folder",\n  "data": [\n    {\n      "id":     "b1b2e7006be",\n      "type":   "folder",\n      "rev":    "8d2e54afd",\n      "name":   "Documents",\n      "access": "private"\n    },\n    {\n      "id":     "d5a80ee7",\n      "type":   "folder",\n      "rev":    "9586f36z",\n      "name":   "Pictures",\n      "access": "public"\n    }\n  ]\n  /* ... other collection attributes ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"delete-operation"},"Delete Operation"),(0,i.kt)("p",null,"The delete operation deletes the item given by the request URL."),(0,i.kt)("h3",{id:"single-resource-2"},"Single resource"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"DELETE /v1/folders/b1b2e7006be HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 204 No Content\n\n")),(0,i.kt)("h3",{id:"multiple-resources-2"},"Multiple Resources"),(0,i.kt)("p",null,"When deleting multiple resources, the service MUST ensure that the operation is atomic."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Either ALL the deletes succeed and a 2xx response code is returned,"),(0,i.kt)("li",{parentName:"ul"},"or NONE of the deletes are committed and a 4xx or 5xx code is returned."),(0,i.kt)("li",{parentName:"ul"},"If this is not possible, do not allow multiple deletes."),(0,i.kt)("li",{parentName:"ul"},"The service SHOULD document and limit the number of resources that may be deletes in one request and return a 400 error if the limit is exceeded.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'DELETE /v1/folders/ HTTP/1.1\nContent-Type: text/json\n\n[\n  "b1b2e7006be",\n  "another_folder_id",\n  /* ... more resource IDs ... */\n]\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 204 No Content\n\n")),(0,i.kt)("h3",{id:"all-resources-in-a-collection"},"All resources in a collection"),(0,i.kt)("p",null,"If appropriate for your service, collections MAY support:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'A "truncate" action to delete all the resources in the collection (but not the collection itself).'),(0,i.kt)("li",{parentName:"ul"},'A "recursiveDelete" action to truncate and then delete the collection itself.')),(0,i.kt)("h3",{id:"deleted-resources"},"Deleted Resources"),(0,i.kt)("p",null,"Services MAY continue to return resources that have been recently deleted in ",(0,i.kt)("a",{parentName:"p",href:"#query-operation"},"query")," and ",(0,i.kt)("a",{parentName:"p",href:"#read-operation"},"read")," operations. This is a ",(0,i.kt)("a",{parentName:"p",href:"http://blog.rightscale.com/2010/02/13/top-cloud-api-sins/"},"suggestion from RightScale"),"; It is easier for some use cases for the client to explicitly see that a resource has been removed than it is to infer that it is gone because it no longer comes back in query responses."),(0,i.kt)("p",null,"Deleted resources:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MUST have a ",(0,i.kt)("inlineCode",{parentName:"li"},"removed:")," or similar attribute that the client can use to differentiate them from resources that still exist."),(0,i.kt)("li",{parentName:"ul"},"SHOULD support filtering on that attribute so clients that don't want them can get results that omit removed results."),(0,i.kt)("li",{parentName:"ul"},"SHOULD stop being returned in query results after a documented period of time on the order of a few hours to days.")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"replace-operation"},"Replace Operation"),(0,i.kt)("p",null,"The replace operation is an atomic combination of the ",(0,i.kt)("a",{parentName:"p",href:"#query-operation"},"query"),", ",(0,i.kt)("a",{parentName:"p",href:"#delete-operation"},"delete"),", and ",(0,i.kt)("a",{parentName:"p",href:"#create-operation"},"create")," operations."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The request URL is treated as a query operation."),(0,i.kt)("li",{parentName:"ul"},"Any matching resources are deleted."),(0,i.kt)("li",{parentName:"ul"},"New resources described in the request body are created.")),(0,i.kt)("p",null,"Services MAY implement replace for any collections where they see fit. It is most useful when updating a many-to-many relationship. For example, associating a list of IP addresses to a firewall rule. Updating this list would require a client UI to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Perform a query to get the current associations."),(0,i.kt)("li",{parentName:"ul"},"Diff the result against what the new entries should be."),(0,i.kt)("li",{parentName:"ul"},"Issue delete operation(s) for the ones that need to be removed."),(0,i.kt)("li",{parentName:"ul"},"Issue create operation(s) for the ones that need to be added."),(0,i.kt)("li",{parentName:"ul"},"Somehow resolve being in an inconsistent state if an error occurs partway through this process.")),(0,i.kt)("p",null,"Replace performs all this in one convenient and atomic action for the client."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The service MUST ensure that this entire operation is atomic."),(0,i.kt)("li",{parentName:"ul"},"Either ALL the changes succeed and a 2xx response code is returned,"),(0,i.kt)("li",{parentName:"ul"},"or NONE of the changes are committed and a 4xx or 5xx code is returned.")),(0,i.kt)("p",null,"The response SHOULD return the list of newly created resources, just as if the request were a normal create."),(0,i.kt)("p",null,"Note: this operation uses a non-standard HTTP method. There's nothing wrong with that, but some clients may not support arbitrary methods."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'REPLACE /v1/firewalls/42/allow HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n[\n  {"ip": "172.16.234.12"},\n  {"ip": "10.1.2.3"}\n]\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "type": "collection",\n  "data": [\n    {"id": "1234", "ip": "172.16.234.12"},\n    {"id": "1235", "ip": "10.1.2.3"},\n  }\n  /* ... more collection attributes ... */\n}\n')),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"action-operation"},"Action Operation"),(0,i.kt)("p",null,"The action operation allows a client to manipulate a resource or collection in a way that cannot be done with any of the other standard operations. The request MAY include a body with additional information (arguments), and the response MAY contain a response body with result info."),(0,i.kt)("p",null,"Actions MAY (and generally SHOULD) incur side effects. The actions that may be possible for given a resource type are defined in its ",(0,i.kt)("a",{parentName:"p",href:"#schemas"},"schema"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"actions:")," attribute in a resource specifies which actions are actually available for this particular resource and the URL to request to perform them."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'POST /v1/folders/b1b2e7006be?encrypt HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: application/json\n\n{\n  "password": "purple monkey dishwasher"\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 202 Accepted\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  /* ... updated representation of the resource ... */\n}\n")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"nesting"},"Nesting"),(0,i.kt)("p",null,"Resources and collections MAY be nested. For example, folders might be associated to files, and files to a collection of tags:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/folders/d5a80ee7/files/b1b2e7006be/tags HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "type": "collection",\n  "resourceType": "tag",\n  "data": [\n    {"type: "tag", /*... more tag attributes ... */},\n    /* ... more tag resources ... */\n  ]\n  /* ... more collection attributes ... */\n}\n')),(0,i.kt)("p",null,"Or the content of the files stored might be exposed as a sub-resource:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"PUT /v1/files/b1b2e7006be/content HTTP/1.1\nAccept: application/json\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\nContent-Type: text/plain\nContent-Length: 2\n\n42\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 204 No Content\nContent-Type: application/json\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/files/b1b2e7006be/content HTTP/1.1\nAuthorization: Basic YWNjZXNzX2tleTpzZWNyZXRfa2V5\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 200 OK\nContent-Type: text/plain\nContent-Length: 2\n\n42\n")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"resource-versioning"},"Resource Versioning"),(0,i.kt)("p",null,"Some (or all) resources MAY implement resource versioning. Versioning allows for the client to perform multiple concurrent updates on a resource and resolve conflicts when they occur."),(0,i.kt)("p",null,"For resources that implement versioning:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The service MUST return resource version in responses as the ",(0,i.kt)("inlineCode",{parentName:"li"},"rev:")," attribute in query and read operations."),(0,i.kt)("li",{parentName:"ul"},"The client MUST include the ",(0,i.kt)("inlineCode",{parentName:"li"},"rev:")," attribute in update, patch, and action operations.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"If the revision given does not match the current revision when the request is processed, the service MUST return a 409 error."))),(0,i.kt)("li",{parentName:"ul"},"The service MUST change the ",(0,i.kt)("inlineCode",{parentName:"li"},"rev:")," attribute whenever a field in the resource changes.")),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"base-url-and-versioning"},"Base URL and Versioning"),(0,i.kt)("p",null,"The base URL that users access your API with SHOULD be of the form:\n",(0,i.kt)("inlineCode",{parentName:"p"},"https://api{-optional-region-code}.{your product domain}/")),(0,i.kt)("p",null,"APIs SHOULD have a separate DNS record from the your web/app, so that the API can be scaled separately from the rest of your stack. The name can always point to the web/app servers if this scale is not yet needed."),(0,i.kt)("p",null,"All public APIs that require authentication MUST be accessible over HTTPS, authenticated public APIs MUST NOT be accessible over a non-encrypted channel. Unauthenticated public APIs MAY be provided over HTTP, but SHOULD also offer HTTPS."),(0,i.kt)("h2",{id:"api-versioning"},"API Versioning"),(0,i.kt)("p",null,"APIs MUST support more than one version of their implementation. Clients MUST specify the particular version they want, and the application MUST NOT make changes that are not backwards compatible to that version."),(0,i.kt)("p",null,'Breaking changes should be avoided when possible, but you are eventually going to have to make a breaking change and it is far better to plan for it from the start. The suggested format for the version string is the letter "v" followed by a single integer which increases by one for each revision (e.g. ',(0,i.kt)("strong",{parentName:"p"},"v1"),", ",(0,i.kt)("strong",{parentName:"p"},"v2"),", ",(0,i.kt)("strong",{parentName:"p"},"v3"),", etc.). The version should be places at the first level of the services URI structure The version SHOULD be treated as an opaque string to the client, so any other format MAY be used."),(0,i.kt)("p",null,'Versions resources MAY also have a "revision" string attribute that changes on each release. This can be useful to help debug issues caused by changes made within a version that are supposed to be compatible with each other.'),(0,i.kt)("p",null,"Outdated versions SHOULD be deprecated and eventually removed from the service. A request for a version that has been removed SHOULD return a 404 error."),(0,i.kt)("h3",{id:"listing"},"Listing"),(0,i.kt)("p",null,'Clients MUST be able to make a GET request to the base URL (without a version fragment) to find out what versions are available. This request SHOULD NOT require authentication. Clients SHOULD check the "latest" link periodically and take action if they are no longer using the latest version.'),(0,i.kt)("p",null,"See the ",(0,i.kt)("a",{parentName:"p",href:"#root-level"},"root level")," and ",(0,i.kt)("a",{parentName:"p",href:"#individual-version"},"individual version")," read operation for more info."),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"design-considerations"},"Design Considerations"),(0,i.kt)("h2",{id:"asynchronous-actions"},"Asynchronous Actions"),(0,i.kt)("p",null,"Interactions that involve longer processing than a single HTTP transaction should wait or for interactions that have reduced urgency may adopt an asynchronous (queued) behavior over a synchronous (blocking) one. A server that accepts a request from a client MUST respond with a HTTP 201 Accepted result and provide a method to retrieve the results in the response body that include a URI of where the results will be and an absolute time that the client should attempt again."),(0,i.kt)("p",null,"Once an asynchronous action has been fulfilled, the URI provided to the client will return the results as if it had been performed synchronously, including a typical 2xx or 4xx status code and corresponding response body."),(0,i.kt)("p",null,"Asynchronous actions MAY fail after having been accepted."),(0,i.kt)("h2",{id:"identifiers"},"Identifiers"),(0,i.kt)("p",null,"Resource Identifiers"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"MUST be unique among other resources of the same type."),(0,i.kt)("li",{parentName:"ul"},"MUST consist only of URL-safe characters."),(0,i.kt)("li",{parentName:"ul"},"SHOULD be globally unique, if practical."),(0,i.kt)("li",{parentName:"ul"},"SHOULD be a string. Numbers require care to avoid eventual overflow."),(0,i.kt)("li",{parentName:"ul"},"MAY be represented as ",(0,i.kt)("a",{parentName:"li",href:"http://www.crockford.com/wrmg/base32.html"},"base32")," for enhanced readability and error resistance."),(0,i.kt)("li",{parentName:"ul"},"SHOULD NOT be an auto-incrementing ID from a database.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Exposing this value reveals information about the size and growth of the service, and easily allows attackers to guess other valid IDs.")))),(0,i.kt)("p",null,"In general something along the lines of a ",(0,i.kt)("a",{parentName:"p",href:"http://www.ietf.org/rfc/rfc4122.txt"},"GUID")," is best if there will be many of the resource or they are dynamically created. A short human-readable string may be appropriate if there is a very limited set of possible resources."),(0,i.kt)("h2",{id:"canonical-links"},"Canonical Links"),(0,i.kt)("p",null,"Each resource SHOULD have a single canonical URL and the representation of that resource SHOULD NOT change depending on how the client got to it."),(0,i.kt)("p",null,"If a file resource is accessible at ",(0,i.kt)("inlineCode",{parentName:"p"},"https://base/v1/files/b1b2e7006be")," and as a data item in a collection ",(0,i.kt)("inlineCode",{parentName:"p"},"https://base/v1/folders/d5a80ee7/files"),", both representations SHOULD be exactly the same."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The links inside the resource SHOULD reflect the canonical URL."),(0,i.kt)("li",{parentName:"ul"},"This prevents the service from generating arbitrarily long link URLs that contain unnecessary history of how the client got to where they are."),(0,i.kt)("li",{parentName:"ul"},"It also makes it possible to compare 2 representations and determine if they are in fact the same resource.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/files/b1b2e7006be HTTP/1.1\nAccept: application/json\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "id":      "b1b2e7006be",\n  "type":    "file",\n  "links":   {\n    "self":     "https://base/v1/files/b1b2e7006be",\n    "schemas":  "https://base/v1/schemas",\n    "content":  "https://base/v1/files/b1b2e7006be/content",\n    "folder":   "https://base/v1/folders/19c3932wef",\n    "public":   "http://documents.your-files.com/ultimate_answer.txt"\n  },\n  "actions": {\n      "encrypt": "htps://base/v1/files/b1b2e7006be?encrypt"\n    },\n  "name":    "ultimate_answer.txt",\n  /* ...  more attributes ... */\n}\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},"GET /v1/folders/d5a80ee7/files HTTP/1.1\nAccept: application/json\n\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\nContent-Type: application/json\nX-API-Schemas: https://base/v1/schemas\n\n{\n  "type": "collection",\n  "links": {\n    "self": "https://base/v1/folders/d5a80ee7/files",\n    "schemas": "https://base/v1/schemas"\n  }\n  /* ... more attributes ... */\n  "data": [\n    {\n      "id":      "b1b2e7006be",\n      "type":    "file",\n      /* the same JSON for file b1b2e7006be, as above */\n    }\n    /* ... more resources ... */\n  ]\n}\n')),(0,i.kt)("h2",{id:"in-line-data"},"In-line Data"),(0,i.kt)("p",null,"Wherever possible binary (or non-textual) data should not be contained within its represented state, such as JSON or XML. The preferred method is for the representation to contain an absolute URI to the resource."),(0,i.kt)("p",null,"If it is desired to embed small amounts of information within a representation, it is advised to conform to the ",(0,i.kt)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/Data_URI_scheme"},"Data URI Scheme")," as found in CSS and HTML. When utilizing this format services MUST use discrete fields in schema to identify when to expect a URI or inline data. The two should NEVER share the same field."),(0,i.kt)("h2",{id:"naming-conventions"},"Naming Conventions"),(0,i.kt)("p",null,"Several keywords are reserved by this standard and have specific meanings. These words MUST ONLY be used for their documented purpose:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"In schemas:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"resourceRepresentations:")))),(0,i.kt)("li",{parentName:"ul"},"In resources:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"id:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"type:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"rev:")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"links:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"actions:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"length:")))),(0,i.kt)("li",{parentName:"ul"},"In collections:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"(Everything reserved for resources)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"filters:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"pagination:"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"sort:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"sortLinks:"),","),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"createTypes:"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"createDefaults:")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"data:")))),(0,i.kt)("li",{parentName:"ul"},"In resource and collection ",(0,i.kt)("inlineCode",{parentName:"li"},"links:"),":",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"self:")))),(0,i.kt)("li",{parentName:"ul"},"In query strings:",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For pagination: ",(0,i.kt)("inlineCode",{parentName:"li"},"marker"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"limit")),(0,i.kt)("li",{parentName:"ul"},"For sorting: ",(0,i.kt)("inlineCode",{parentName:"li"},"sort"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"order")),(0,i.kt)("li",{parentName:"ul"},"For usability: ",(0,i.kt)("inlineCode",{parentName:"li"},"_accept"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"_format"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"_method"))))),(0,i.kt)("p",null,"Some additional guidelines:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Names and attribute keys should be a single word when practical."),(0,i.kt)("li",{parentName:"ul"},"Single-word collection, resource, attribute names SHOULD be all lowercase."),(0,i.kt)("li",{parentName:"ul"},"Multiple words SHOULD be interCaps (also known as camelCase), not dash-separated, under_scored, or TitleCase."),(0,i.kt)("li",{parentName:"ul"},"Resource names SHOULD be singular, not plural.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"These appear in a ",(0,i.kt)("a",{parentName:"li",href:"#resources"},"resources's")," ",(0,i.kt)("inlineCode",{parentName:"li"},"type:")," and ",(0,i.kt)("a",{parentName:"li",href:"#schemas"},"schema's")," ",(0,i.kt)("inlineCode",{parentName:"li"},"id:"),".")))),(0,i.kt)("h2",{id:"uri-conventions"},"URI Conventions"),(0,i.kt)("p",null,'REST URI conventions are a flexible concept by nature allowing no "wrong" way to generate one. With usability in mind there are two general rules that SHOULD be followed:'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Resource URIs should remain static"),(0,i.kt)("li",{parentName:"ul"},"Simple and short is better than long and explicit")),(0,i.kt)("p",null,"Resources can be classified into two categories, singular and complex relationships. Singular resources are those that stand alone without requiring other resources to function. Complex resources on the other hand have relationships with other resources and can be represented in multiple ways. Take for example a users shopping cart, a ",(0,i.kt)("inlineCode",{parentName:"p"},"user")," has a ",(0,i.kt)("inlineCode",{parentName:"p"},"basket"),", a basket has ",(0,i.kt)("inlineCode",{parentName:"p"},"item"),"s. A useful set of URIs for resources would be:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"/v1/users               # List all Users\n/v1/users/1234/basket   # Get the basket for User 1234\n/v1/basket/5678         # Get Basket 5678\n/v1/basket/5678/items   # List all Items in Basket 5678\n/v1/items               # List all Items\n/v1/items/9012          # Get Item 9012\n")),(0,i.kt)("p",null,"In other words, it is RECOMMENDED that complex types follow a ",(0,i.kt)("inlineCode",{parentName:"p"},"/resource/id/subresource")," model."),(0,i.kt)("p",null,"See ",(0,i.kt)("a",{parentName:"p",href:"#canonical-links"},"Canonical Links")),(0,i.kt)("h2",{id:"performance"},"Performance"),(0,i.kt)("h3",{id:"caching"},"Caching"),(0,i.kt)("p",null,"Services SHOULD do everything they can to enable the clients to take advantage of caching as much as possible."),(0,i.kt)("h4",{id:"cache-control"},"Cache-Control"),(0,i.kt)("p",null,"Read and Query operations SHOULD return a ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.9"},"Cache-Control")," header with values that are appropriate for the information being returned. If the data changes infrequently, allow clients to cache it for a reasonable period of time."),(0,i.kt)("h4",{id:"etag"},"ETag"),(0,i.kt)("p",null,"Read operations SHOULD return a HTTP ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.19"},"ETag")," header with an opaque value. The opaque value MUST uniquely describe the entire resource, and change if any part of the resource is changed. This can often be done as a hash of the serialized resource representation, e.g. convert the resource to a JSON string and return a sha-sum of the string."),(0,i.kt)("p",null,"Query operations SHOULD also return an ETag. The opaque value MUST uniquely describe the entire result set and change if any of the resources or metadata are changed/added/removed."),(0,i.kt)("p",null,"Clients MAY send an ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.26"},"If-None-Match")," header along with their query or read operation. The service SHOULD compute its response, and if that response has the same ETag value, return a 304 status instead of transmitting the entire response again."),(0,i.kt)("h4",{id:"last-modified"},"Last-Modified"),(0,i.kt)("p",null,"Whenever possible, services SHOULD keep a last modified date and return a ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-13.3"},"Last-Modified")," header on Read and Query operations."),(0,i.kt)("p",null,"Clients MAY send an ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.25"},"If-Modified-Since")," header. The service SHOULD return a 304 status instead of transmitting the entire response again if it hasn't changed since the time given."),(0,i.kt)("h3",{id:"compression"},"Compression"),(0,i.kt)("p",null,"API Services SHOULD support gzip and deflate compression and deliver responses with an appropriate ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.11"},"Content-Encoding")," header according to the ",(0,i.kt)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc2616#section-14.3"},"Accept-Encoding")," requested by the client."),(0,i.kt)("h2",{id:"query-string-length"},"Query String Length"),(0,i.kt)("p",null,"Many clients, frameworks, and web servers limit the length of query strings and the request URL as a whole. Services SHOULD be designed so that clients never have any good reason to make a request for a URL longer than 2048 bytes. Services MAY return a 413 error if a request URL is longer than they wish to handle."),(0,i.kt)("h2",{id:"regions--geographic-diversity"},"Regions & Geographic Diversity"),(0,i.kt)("p",null,"Many services have resources that exist in multiple geographic regions."),(0,i.kt)("p",null,"To provide the easiest management for the user, APIs SHOULD provide a single unified endpoint that can manage resources in all regions. This endpoint MAY have servers in each region and use geographic load balancing (Geographic DNS, Shortest Cost Network Path, etc.) to direct the requests to the closest region."),(0,i.kt)("p",null,"In applications where centralized management is not possible, each region MAY have a separate endpoint with a region code identified in the base URL."),(0,i.kt)("h2",{id:"what-to-link"},"What to Link"),(0,i.kt)("p",null,"Guidelines for creating links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Every reference to the ",(0,i.kt)("inlineCode",{parentName:"li"},"id:")," of another resource SHOULD have a corresponding link.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"For example if a file resource has a ",(0,i.kt)("inlineCode",{parentName:"li"},"folderId:")," field, there should be a ",(0,i.kt)("inlineCode",{parentName:"li"},"folder:")," link."))),(0,i.kt)("li",{parentName:"ul"},"Links to a single resource SHOULD be singular.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},'"content": "https://base/v1/files/b1b2e7006be/content"')))),(0,i.kt)("li",{parentName:"ul"},"Links to a collection SHOULD be plural.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"e.g. ",(0,i.kt)("inlineCode",{parentName:"li"},'"files": "https://base/v1/folders/d5a80ee7/files"')))),(0,i.kt)("li",{parentName:"ul"},"Limit your URL namespace as much as possible. The less surface area you have exposed the less there is that might need to change later."),(0,i.kt)("li",{parentName:"ul"},"Path components and query parameter names SHOULD be short, meaningful words in all lowercase, easy for a human to read."),(0,i.kt)("li",{parentName:"ul"},"Services SHOULD NOT change the format or construction of URLs within an API version",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"In theory, everyone uses the discoverability features and follows links, so services may change URL formats at any time."),(0,i.kt)("li",{parentName:"ul"},"But some clients will inevitably ignore discoverability and hardcode paths into their code."),(0,i.kt)("li",{parentName:"ul"},"So if a URL needs to be changed, provide a 301/302 redirect or release a new ",(0,i.kt)("a",{parentName:"li",href:"#api-versioning"},"API version"),".")))))}d.isMDXComponent=!0}}]);